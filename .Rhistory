filter(state == "California", county == "Alameda County")
# Alameda summary stats
Alameda_summary <- alameda %>%
summarise(
mean_2010 = mean(upward_mobility_rate_2010, na.rm = TRUE),
sd_2010 = sd(upward_mobility_rate_2010, na.rm = TRUE),
mean_2020 = mean(upward_mobility_rate_2020, na.rm = TRUE),
sd_2020 = sd(upward_mobility_rate_2020, na.rm = TRUE))
# Alameda summary stats
Alameda_summary <- Alameda %>%
summarise(
mean_2010 = mean(upward_mobility_rate_2010, na.rm = TRUE),
sd_2010 = sd(upward_mobility_rate_2010, na.rm = TRUE),
mean_2020 = mean(upward_mobility_rate_2020, na.rm = TRUE),
sd_2020 = sd(upward_mobility_rate_2020, na.rm = TRUE))
# Alameda summary stats
Alameda_summary <- Alameda %>%
summarise(
mean_2010 = mean(upward_mobility_rate_2010, na.rm = TRUE),
sd_2010 = sd(upward_mobility_rate_2010, na.rm = TRUE),
mean_2020 = mean(upward_mobility_rate_2020, na.rm = TRUE),
sd_2020 = sd(upward_mobility_rate_2020, na.rm = TRUE))
# Alameda summary stats
Alameda_summary <- Alameda %>%
summarise(
mean_2010 = mean(upward_mobility_rate_2010, na.rm = TRUE),
sd_2010 = sd(upward_mobility_rate_2010, na.rm = TRUE),
mean_2020 = mean(upward_mobility_rate_2020, na.rm = TRUE),
sd_2020 = sd(upward_mobility_rate_2020, na.rm = TRUE))
# California state averages
california <- data %>%
filter(state == "California")
# group by state
mobility_plot <- ggplot(data = summary_stats_upward_2010_all, mapping = aes(x= STATE_ABBR_2010SVI, y=mean_mobility_2010, fill = STATE_ABBR_2010SVI)) + geom_boxplot()
print(mobility_plot)
# save plot
ggsave(plot = mobility_plot, filename = "output/mobility-plot-2010.pdf")
# Maricopa County
#   2010
print(maricopa_upward_sd_2010_ca <- sd(subset_data_ca$upward_mobility_rate_2010[subset_data_ca$COUNTY_2010SVI == "Maricopa County"]))
# Alameda County
# Maricopa County
#   2010
print(maricopa_upward_sd_2010_az <- sd(subset_data_az$upward_mobility_rate_2010[subset_data_az$COUNTY_2010SVI == "Maricopa County"]))
#   2020
print(maricopa_upward_sd_2020_ca <- sd(subset_data_ca$upward_mobility_rate_2020[subset_data_ca$COUNTY_2010SVI == "Del Norte County"]))
# Alameda County
# Maricopa County
#   2010
print(maricopa_upward_sd_2010_az <- sd(subset_data_az$upward_mobility_rate_2010[subset_data_az$COUNTY_2010SVI == "Maricopa County"]))
#   2020
print(maricopa_upward_sd_2020_az <- sd(subset_data_az$upward_mobility_rate_2020[subset_data_az$COUNTY_2010SVI == "Maricopa County"]))
# Alameda County
# Maricopa County
#   2010
print(maricopa_upward_sd_2010_az <- sd(subset_data_az$upward_mobility_rate_2010[subset_data_az$COUNTY_2010SVI == "Maricopa County"]))
print(mobility_plot)
#   2020
print(maricopa_upward_sd_2020_az <- sd(subset_data_az$upward_mobility_rate_2020[subset_data_az$COUNTY_2010SVI == "Maricopa County"]))
# Alameda County
# Maricopa County
#   2010
print(maricopa_upward_sd_2010_az <- sd(subset_data_az$upward_mobility_rate_2010[subset_data_az$COUNTY_2010SVI == "Maricopa County"]))
print(mobility_plot)
#   2020
print(maricopa_upward_sd_2020_az <- sd(subset_data_az$upward_mobility_rate_2020[subset_data_az$COUNTY_2010SVI == "Maricopa County"]))
print(mobility_plot)
# Alameda County
# Maricopa County
#   2010
print(maricopa_upward_sd_2010_az <- sd(subset_data_az$upward_mobility_rate_2010[subset_data_az$COUNTY_2010SVI == "Maricopa County"]))
print(mobility_plot)
#   2020
print(maricopa_upward_sd_2020_az <- sd(subset_data_az$upward_mobility_rate_2020[subset_data_az$COUNTY_2010SVI == "Maricopa County"]))
print(mobility_plot)
# Alameda County
print(alameda_upward_mean_2010_ca <- mean(subset_data_ca$upward_mobility_rate_2010[subset_data_ca$COUNTY_2010SVI == "Alameda County"]))
# Maricopa County
#   2010
print(maricopa_upward_sd_2010_az <- sd(subset_data_az$upward_mobility_rate_2010[subset_data_az$COUNTY_2010SVI == "Maricopa County"]))
print(mobility_plot)
#   2020
print(maricopa_upward_sd_2020_az <- sd(subset_data_az$upward_mobility_rate_2020[subset_data_az$COUNTY_2010SVI == "Maricopa County"]))
print(mobility_plot)
# Alameda County
#   2010
print(alameda_upward_mean_2010_ca <- mean(subset_data_ca$upward_mobility_rate_2010[subset_data_ca$COUNTY_2010SVI == "Alameda County"]))
#   2020
print(alameda_upward_mean_2020_ca <- mean(subset_data_ca$upward_mobility_rate_2010[subset_data_ca$COUNTY_2020SVI == "Alameda County"]))
# Maricopa County
#   2010
print(maricopa_upward_sd_2010_az <- sd(subset_data_az$upward_mobility_rate_2010[subset_data_az$COUNTY_2010SVI == "Maricopa County"]))
print(mobility_plot)
#   2020
print(maricopa_upward_sd_2020_az <- sd(subset_data_az$upward_mobility_rate_2020[subset_data_az$COUNTY_2010SVI == "Maricopa County"]))
print(mobility_plot)
# Alameda County
#   2010
print(alameda_upward_mean_2010_ca <- mean(subset_data_ca$upward_mobility_rate_2010[subset_data_ca$COUNTY_2010SVI == "Alameda County"]))
#   2020
print(alameda_upward_mean_2020_ca <- mean(subset_data_ca$upward_mobility_rate_2010[subset_data_ca$COUNTY_2020SVI == "Alameda County"]))
# Alameda County
#   2010
print(alameda_upward_mean_2010_ca <- mean(subset_data_ca$upward_mobility_rate_2010[subset_data_ca$COUNTY_2010SVI == "Alameda County"]))
print(mobility_plot)
#   2020
print(alameda_upward_mean_2020_ca <- mean(subset_data_ca$upward_mobility_rate_2010[subset_data_ca$COUNTY_2020SVI == "Alameda County"]))
# Alameda County
#   2010
print(alameda_upward_mean_2010_ca <- mean(subset_data_ca$upward_mobility_rate_2010[subset_data_ca$COUNTY_2010SVI == "Alameda County"]))
print(mobility_plot)
#   2020
print(alameda_upward_mean_2020_ca <- mean(subset_data_ca$upward_mobility_rate_2010[subset_data_ca$COUNTY_2020SVI == "Alameda County"]))
print(mobility_plot)
# Alameda County
#   2010
print(alameda_upward_mean_2010_ca <- mean(subset_data_ca$upward_mobility_rate_2010[subset_data_ca$COUNTY_2010SVI == "Alameda County"]))
print(mobility_plot)
#   2020
print(alameda_upward_mean_2020_ca <- mean(subset_data_ca$upward_mobility_rate_2020[subset_data_ca$COUNTY_2020SVI == "Alameda County"]))
print(mobility_plot)
# Maricopa County
#   2010
print(maricopa_upward_sd_2010_az <- sd(subset_data_az$upward_mobility_rate_2010[subset_data_az$COUNTY_2010SVI == "Maricopa County"]))
print(mobility_plot)
#   2020
print(maricopa_upward_sd_2020_az <- sd(subset_data_az$upward_mobility_rate_2020[subset_data_az$COUNTY_2020SVI == "Maricopa County"]))
print(mobility_plot)
# Alameda County SD
# 2010
print(alameda_upward_sd_2010_ca <- sd(subset_data_ca$upward_mobility_rate_2010[subset_data_ca$COUNTY_2010SVI == "Alameda County"]))
# 2020
print(alameda_upward_sd_2020_ca <- sd(subset_data_ca$upward_mobility_rate_2020[subset_data_ca$COUNTY_2020SVI == "Alameda County"]))
# Alameda County Mean
#   2010
print(alameda_upward_mean_2010_ca <- mean(subset_data_ca$upward_mobility_rate_2010[subset_data_ca$COUNTY_2010SVI == "Alameda County"]))
print(mobility_plot)
#   2020
print(alameda_upward_mean_2020_ca <- mean(subset_data_ca$upward_mobility_rate_2020[subset_data_ca$COUNTY_2020SVI == "Alameda County"]))
print(mobility_plot)
# group by state
mobility_plot <- ggplot(data = summary_stats_upward_2010_all, mapping = aes(x= STATE_ABBR_2010SVI, y=mean_mobility_2010, fill = STATE_ABBR_2010SVI)) + geom_boxplot()
print(mobility_plot_)
# group by state
mobility_plot <- ggplot(data = summary_stats_upward_2010_all, mapping = aes(x= STATE_ABBR_2010SVI, y=mean_mobility_2010, fill = STATE_ABBR_2010SVI)) + geom_boxplot()
print(mobility_plot)
# save plot
ggsave(plot = mobility_plot, filename = "output/mobility-plot-2010.pdf")
# state and county summary
summary_stats_upward_2010_all <- merged_data %>%
group_by(STATE_ABBR_2010SVI, COUNTY_2010SVI) %>%
summarize(mean_mobility_2010 = mean(upward_mobility_rate_2010), sd_mobility_2010 = sd(upward_mobility_rate_2010))
# grouping by state
mobility_plot <- ggplot(data = summary_stats_upward_2010_all, mapping = aes(x = STATE_ABBR_2010SVI, y = mean_mobility_2010)) + geom_boxplot()
print(mobility_plot_by_state_upward)
# visualization with ggplot2
mobility_plot <- ggplot(data = summary_stats_upward_2010,
mapping = aes(x= COUNTY_2010SVI, y=mean_mobility_2010_az)) + geom_boxplot()
# print mobility plot
print(mobility_plot_sumstats)
# visualization with ggplot2
mobility_plot_sumstats <- ggplot(data = summary_stats_upward_2010,
mapping = aes(x= COUNTY_2010SVI, y=mean_mobility_2010_az)) + geom_boxplot()
# print mobility plot
print(mobility_plot_sumstats)
# visualization with ggplot2
mobility_plot_sumstats <- ggplot(data = summary_stats_upward_2010,
mapping = aes(x= COUNTY_2010SVI, y=mean_mobility_2010_az)) + geom_boxplot()
# print mobility plot
print(mobility_plot_sumstats)
# state and county summary
summary_stats_upward_2010_all <- merged_data %>%
group_by(STATE_ABBR_2010SVI, COUNTY_2010SVI) %>%
summarize(mean_mobility_2010 = mean(upward_mobility_rate_2010), sd_mobility_2010 = sd(upward_mobility_rate_2010))
# grouping by state
mobility_plot_by_state_upward <- ggplot(data = summary_stats_upward_2010_all, mapping = aes(x = STATE_ABBR_2010SVI, y = mean_mobility_2010)) + geom_boxplot()
print(mobility_plot_by_state_upward)
# state and county summary
summary_stats_upward_2010_all <- merged_data %>%
group_by(STATE_ABBR_2010SVI, COUNTY_2010SVI) %>%
summarize(mean_mobility_2010 = mean(upward_mobility_rate_2010), sd_mobility_2010 = sd(upward_mobility_rate_2010))
# grouping by state
mobility_plot_by_state_upward <- ggplot(data = summary_stats_upward_2010_all, mapping = aes(x = STATE_ABBR_2010SVI, y = mean_mobility_2010)) + geom_boxplot()
print(mobility_plot_by_state_upward)
# group by state
mobility_plot_sum_by_state <- ggplot(data = summary_stats_upward_2010_all, mapping = aes(x= STATE_ABBR_2010SVI, y=mean_mobility_2010, fill = STATE_ABBR_2010SVI)) + geom_boxplot()
print(mobility_plot_sum_by_state)
# save plot
ggsave(plot = mobility_plot, filename = "output/mobility-plot-2010.pdf")
# group by state
mobility_plot_sum_by_state <- ggplot(data = summary_stats_upward_2010_all, mapping = aes(x= STATE_ABBR_2010SVI, y=mean_mobility_2010, fill = STATE_ABBR_2010SVI)) + geom_boxplot()
print(mobility_plot_sum_by_state)
# save plot
ggsave(plot = mobility_plot, filename = "output/mobility-plot-2010.pdf")
# group by state
mobility_plot_sum_by_state <- ggplot(data = summary_stats_upward_2010_all, mapping = aes(x= STATE_ABBR_2010SVI, y=mean_mobility_2010, fill = STATE_ABBR_2010SVI)) + geom_boxplot()
print(mobility_plot_sum_by_state)
# save plot
ggsave(plot = mobility_plot_sum_by_state, filename = "output/mobility_plot_sum_by_state-2010.pdf")
alameda_summary <- alameda %>%
summarise(
mean_2010 = mean(upward_mobility_rate_2010, na.rm = TRUE),
sd_2010 = sd(upward_mobility_rate_2010 na.rm = TRUE),
alameda_summary <- alameda %>%
summarise(
mean_2010 = mean(upward_mobility_rate_2010, na.rm = TRUE),
sd_2010 = sd(upward_mobility_rate_2010, na.rm = TRUE),
mean_2020 = mean(upward_mobility_rate_2020, na.rm = TRUE),
sd_2020 = sd(upward_mobility_rate_2020, na.rm = TRUE))
alameda <- data %>%
filter(state == "California", county == "Alameda County")
alameda <- data %>%
dplyr: :filter(state == "California", county == "Alameda County")
# create summaries for subset
upward_mean_2010_az <- mean(subset_data_az$upward_mobility_rate_2010,  na.rm = TRUE)
upward_sd_2010_az <- sd(subset_data_az$upward_mobility_rate_2010,  na.rm = TRUE)
upward_mean_2020_az <- mean(subset_data_az$upward_mobility_rate_2020, na.rm = TRUE)
upward_sd_2020_az <- sd(subset_data_az$upward_mobility_rate_2020,  na.rm = TRUE)
# print mean CA (state-level)
subset_data_ca <- subset(merged_data, STATE_ABBR_2010SVI == "CA")
print(upward_mean_2010_ca <- mean(subset_data_ca$upward_mobility_rate_2010,  na.rm = TRUE))
# print mean CA (state-level)
subset_data_ca <- subset(merged_data, STATE_ABBR_2010SVI == "CA")
print(upward_mean_2010_ca <- mean(subset_data_ca$upward_mobility_rate_2010,  na.rm = TRUE))
# print mean CA (state-level)
subset_data_ca <- subset(merged_data, STATE_ABBR_2010SVI == "CA")
print(upward_mean_2010_ca <- mean(subset_data_ca$upward_mobility_rate_2010,  na.rm = TRUE))
# county level summary
# pima upward mean
print(pima_upward_mean_2010_az <- mean(subset_data_az$upward_mobility_rate_2010[subset_data_az$COUNTY_2010SVI == "Pima County"],  na.rm = TRUE))
# pima upward sd
print(pima_upward_sd_2010_az <- sd(subset_data_az$upward_mobility_rate_2010[subset_data_az$COUNTY_2010SVI == "Pima County"]))
# del norte upward mean
print(delnorte_upward_mean_2010_ca <- mean(subset_data_ca$upward_mobility_rate_2010[subset_data_ca$COUNTY_2010SVI == "Del Norte County"]))))
# county level summary
# pima upward mean
print(pima_upward_mean_2010_az <- mean(subset_data_az$upward_mobility_rate_2010[subset_data_az$COUNTY_2010SVI == "Pima County"],  na.rm = TRUE))
# pima upward sd
print(pima_upward_sd_2010_az <- sd(subset_data_az$upward_mobility_rate_2010[subset_data_az$COUNTY_2010SVI == "Pima County"]))
# del norte upward mean
print(delnorte_upward_mean_2010_ca <- mean(subset_data_ca$upward_mobility_rate_2010[subset_data_ca$COUNTY_2010SVI == "Del Norte County"]))))
# county level summary
# pima upward mean
print(pima_upward_mean_2010_az <- mean(subset_data_az$upward_mobility_rate_2010[subset_data_az$COUNTY_2010SVI == "Pima County"],  na.rm = TRUE))
# pima upward sd
print(pima_upward_sd_2010_az <- sd(subset_data_az$upward_mobility_rate_2010[subset_data_az$COUNTY_2010SVI == "Pima County"]))
# del norte upward mean
print(delnorte_upward_mean_2010_ca <- mean(subset_data_ca$upward_mobility_rate_2010[subset_data_ca$COUNTY_2010SVI == "Del Norte County"]))
# county level summary
# pima upward mean
print(pima_upward_mean_2010_az <- mean(subset_data_az$upward_mobility_rate_2010[subset_data_az$COUNTY_2010SVI == "Pima County"],  na.rm = TRUE))
# pima upward sd
print(pima_upward_sd_2010_az <- sd(subset_data_az$upward_mobility_rate_2010[subset_data_az$COUNTY_2010SVI == "Pima County"]))
# del norte upward mean
print(delnorte_upward_mean_2010_ca <- mean(subset_data_ca$upward_mobility_rate_2010[subset_data_ca$COUNTY_2010SVI == "Del Norte County"]))
# print standard deviation for Pima County (Arizona)
print(pima_sd_2010_az <- sd(subset_data_az$upward_mobility_rate_2010[subset_data_az$COUNTY_2010SVI == "Pima County"], na.rm = TRUE))
# print standard deviation for Del Norte County (California)
# print standard deviation for Del Norte County (California)
print(delnorte_sd_2010_ca <- sd(subset_data_ca$upward_mobility_rate_2010[subset_data_ca$COUNTY_2010SVI == "Del Norte County"], na.rm = TRUE))
# Alameda County Filtering
alameda <- merged_data %>%
filter(STATE_ABBR_2010SVI == "CA", COUNTY_2010SVI == "Alameda County")
alameda_summary <- alameda %>%
summarise(
mean_2010 = mean(upward_mobility_rate_2010, na.rm = TRUE),
sd_2010 = sd(upward_mobility_rate_2010, na.rm = TRUE),
mean_2020 = mean(upward_mobility_rate_2020, na.rm = TRUE),
sd_2020 = sd(upward_mobility_rate_2020, na.rm = TRUE))
# Alameda County Filtering
alameda <- merged_data %>%
filter(STATE_ABBR_2010SVI == "CA", COUNTY_2010SVI == "Alameda County")
# Alameda County Summary Stats
alameda_summary <- alameda %>%
summarise(
mean_2010 = mean(upward_mobility_rate_2010, na.rm = TRUE),
sd_2010 = sd(upward_mobility_rate_2010, na.rm = TRUE),
mean_2020 = mean(upward_mobility_rate_2020, na.rm = TRUE),
sd_2020 = sd(upward_mobility_rate_2020, na.rm = TRUE))
# run Alameda
print(alameda_summary)
#   Boxplot Selected County
#Maricopa County Filtering
maricopa <- subset_data_az[subset_data_az$COUNTY_2010SVI == "Maricopa County", ]
# Summary Stats for Maricopa
maricopa_summary <- maricopa %>%
summarise(
mean_2010 = mean(upward_mobility_rate_2010, na.rm = TRUE),
sd_2010 = sd(upward_mobility_rate_2010, na.rm = TRUE),
mean_2020 = mean(upward_mobility_rate_2020, na.rm = TRUE),
sd_2020 = sd(upward_mobility_rate_2020, na.rm = TRUE)
)
# Summary Stats for Maricopa
maricopa_summary <- maricopa %>%
summarise(
mean_2010 = mean(upward_mobility_rate_2010, na.rm = TRUE),
sd_2010 = sd(upward_mobility_rate_2010, na.rm = TRUE),
mean_2020 = mean(upward_mobility_rate_2020, na.rm = TRUE),
sd_2020 = sd(upward_mobility_rate_2020, na.rm = TRUE)
)
# run it
print(maricopa_summary)
# Alameda County Filtering
alameda <- merged_data %>%
filter(STATE_ABBR_2010SVI == "CA", COUNTY_2010SVI == "Alameda County")
# Alameda County Summary Stats
alameda_summary <- alameda %>%
summarise(
mean_2010 = mean(upward_mobility_rate_2010, na.rm = TRUE),
sd_2010 = sd(upward_mobility_rate_2010, na.rm = TRUE),
mean_2020 = mean(upward_mobility_rate_2020, na.rm = TRUE),
sd_2020 = sd(upward_mobility_rate_2020, na.rm = TRUE))
# run Alameda
print(alameda_summary)
# Summary Stats for Maricopa
maricopa_summary <- maricopa %>%
summarise(
mean_2010 = mean(upward_mobility_rate_2010, na.rm = TRUE),
sd_2010 = sd(upward_mobility_rate_2010, na.rm = TRUE),
mean_2020 = mean(upward_mobility_rate_2020, na.rm = TRUE),
sd_2020 = sd(upward_mobility_rate_2020, na.rm = TRUE)
)
# run it
print(maricopa_summary)
subset_data_az$County_Group <- ifelse(subset_data_az$COUNTY_2010SVI == "Maricopa County", "Maricopa", "Other Counties")
ggplot(data = subset_data_az, aes(x = County_Group, y = upward_mobility_rate_2010)) + geom_boxplot(fill = "skyblue") + labs(title = "Upward Mobility: Maricopa vs. Other AZ Counties (2010)", x = "", y = "Upward MObility Rate (2010)")
install.packages("tidyverse")
#Load packages
library(arrow) # reading in parquet files
library(arrow)
library(tidyverse)
merged_data <- read_parquet(file = "merged_data.parquet", stringsAsFactors = TRUE)
# box plot vizualization
boxplot(formula = upward_mobility_rate_2010 ~ STATE_NAME_2010SVI, data = merges_data)
# box plot vizualization
boxplot(formula = upward_mobility_rate_2010 ~ STATE_NAME_2010SVI, data = merged_data)
# remove anomalies
merged_data <- merged_data[!(merged_data$STATE_NAME_2010SVI %in% "06"),]
merged_data <- merged_data[!(merged_data$STATE_NAME_2010SVI %in% "06"),]
# re-plot boxplot to confirm the issue is resolved
boxplot(formula = upward_mobility_rate_2010 ~ STATE_NAME_2010SVI, data = merged_data)
# new box plot to explore total population by state:
boxplot(formula = M_TOTPOP_2010SVI ~ STATE_NAME_2010SVI, data = merged_data)
install.packages("tidyverse")
library(tidyverse)
subset_data_ca <- subset(merged_data, STATE_ABBR_2010SVI == "CA")
subset_data_az <- subset(merged_data, STATE_ABBR_2010SVI == "AZ")
print(upward_mean_2010_ca <- mean(subset_data_ca$upward_mobility_rate_2010))
#   arizona
print(upward_mean_2010_az <- mean(subset_data_az$upward_mobility_rate_2010))
# store them in a new data frame so they're easier to use
upward_mobility_means_2010 <- data.frame(State = c("CA", "AZ"),
up_2010_mean = c(upward_mean_2010_ca, upward_mean_2010_az))
upward_mobility_means_2010 <- data.frame(State = c("CA", "AZ"), up_2010_mean = c(upward_mean_2010_ca, upward_mean_2010_az))
state_group <- merged_data %>%
group_by(STATE_ABBR_2010SVI)
install.packages("tidyverse")
library(tidyverse)
state_group <- merged_data %>%
group_by(STATE_ABBR_2010SVI)
state_mob_means <- state_group %>%
summarise(up_mean = mean(upward_mobility_rate_2010, na.rm = TRUE))
state_mob_means <- state_mob_means %>%
filter(!is.na(STATE_ABBR_2010SVI))
state_mob_means <- state_mob_means %>%
filter(!is.na(STATE_ABBR_2010SVI))
# 3.4 The Pipe Operator %>%
#   start with full dataset (merged_data), group it by state, calculate mean upward mobility rate
upward <- merged_data %>%
group_by(STATE_ABBR_2010SVI) %>%
summarise(means_2010 = mean(upward_mobility_rate_2010, na.rm = TRUE))
#   remove rows where state is NA
upward <- upward %>% filter(!is.na(STATE_ABBR_2010SVI))
upward_stats <- merged_data %>%
group_by(STATE_ABBR_2010SVI, COUNTY_2010SVI) %>%
summarise(up_means = mean(upward_mobility_rate_2010, na.rm = TRUE),
up_se = sd(upward_mobility_rate_2010, na.rm = TRUE)/sqrt(n()))
#   drop the NA
upward_stats <- upward_stats %>% filter(!is.na(STATE_ABBR_2010SVI))
# plot mean upward mobility per state using ggplot2
ggplot(data = upward_stats, mapping = aes(x = STATE_ABBR_2010SVI, y = up_means))
# add our component using the + sign
ggplot(data = upward_stats, mapping = aes(x = STATE_ABBR_2010SVI, y = up_means)) +
geom_point()
# add error bars using geom_errorbar().
ggplot(data = upward_stats, mapping = aes(x = STATE_ABBR_2010SVI, y = up_means)) +
geom_point() +
geom_errorbar(mapping = aes(ymin = up_means - up_se,
ymax = up_means + up_se))
ggplot(data = upward_stats, mapping = aes(x = STATE_ABBR_2010SVI, y = up_means)) +
geom_point() +
geom_errorbar(mapping = aes(ymin = up_means - up_se,
ymax = up_means + up_se),
width = 0.30)
upward_stats_st <- merged_data %>%
group_by(STATE_ABBR_2010SVI) %>%
summarize(up_means = mean(upward_mobility_rate_2010),
up_se = sd(upward_mobility_rate_2010)/sqrt(n()))
# drop the NA
upward_stats_st <- upward_stats_st %>% filter(!is.na(STATE_ABBR_2010SVI))
# redo the graph
ggplot(data = upward_stats_st, mapping = aes(x = STATE_ABBR_2010SVI, y = up_means)) +
geom_point() +
geom_errorbar(mapping = aes(ymin = up_means - up_se,
ymax = up_means + up_se),
width = 0.30)
merged <- merged_data
merged %>%
dplyr:: select(!contains("_"), starts_with ("upward"))
#   reordering columns
merged <- merged %>%
dplyr:: relocate(contains("STATE"), .after = upward_mobility_rate_2020)
# create and place a unique identifier
unique_id <- merged %>%
dplyr:: group_by(STATE_FIPS_2010SVI, COUNTY_2010SVI, CENSUSAREA_2010SVI) %>%
dplyr:: mutate(uniqueid = row_number(), .before = contains("_"))
merged_stats_up <- merged %>%
dplyr::group_by(STATE_ABBR_2010SVI) %>%
dplyr::summarize(across(starts_with("upward"),
list(~mean(.x, na.rm = TRUE),
~sd(.x, na.rm = TRUE))))
# rename columns when summarizing
merged_stats_up <- merged %>%
dplyr::group_by(STATE_ABBR_2010SVI) %>%
dplyr::summarize(across(starts_with("upward"),
list(mean = ~mean(.x, na.rm = TRUE),
sd = ~sd(.x, na.rm = TRUE)),
.names = "{gsub('_', '', col)}_{fn}"))
# 3.7 Advanced: modeling and nesting
pward_models <- merged %>%
group_by(STATE_ABBR_2010SVI) %>% summarise(model list(lm(upward_mobility_rate_2010 ~ POP2010)))
upward_models <- merged %>%
group_by(STATE_ABBR_2010SVI) %>% summarise(model list(lm(upward_mobility_rate_2010 ~ POP2010)))
upward_models <- merged %>%
group_by(STATE_ABBR_2010SVI) %>% summarise(model list(lm(upward_mobility_rate_2010 ~ POP2010)))
# 3.7 Advanced: modeling and nesting
merged <- nest_by(state_group)
# 4 Running a basic statistical test: student's t-test
# start fresh
merged <- merged_data
az <- merged_data[merged_data$STATE_NAME_2010SVI == "Arizona", ]
ca <- merged_data[merged_data$STATE_NAME_2010SVI == "California", ]
# see how many rows and columns
dim(merged_data)
# return all columns for the third row in merged data:
merged_data[3,]
# or the third column
merged_data[,3]
#   check observations
print(nrow(az))
print(nrow(ca))
#   test the upward mobility rate in these two states significantly different?
t.test(x = az$upward_mobility_rate_2010, y = ca$upward_mobility_rate_2010)
# ANOVA: Multiple group comparisons, comparing the means between groups
#   to see if there is a statistically significant difference
aov(formula = upward_mobility_rate_2010 ~ COUNTY_2010SVI, data = az)
#   comparing mobility rate between counties
mobility_rate_az_aov <- aov(formula = upward_mobility_rate_2010 ~ COUNTY_2010SVI, data = az)
#   is the mobility rate explained by the county you're in
summary(object = mobility_rate_az_aov)
sink()
sink(file = "output/az_mobility_anova.txt")
summary(object = mobility_rate_az_aov)
sink()
# linear regression
#     tells us; is there a pattern, how strong is the pattern, can we use it to predict things?
summary(merged_data[, 1:10], 6)
#     visualize it
plot(x = merged_data$upward_mobility_rate_2010, y = merged_data$M_TOTPOP_2010SVI)
#   log-transformed data
merged$logpop <-log10(merged$M_TOTPOP_2010SVI)
#   plot again
plot(x = merged$upward_mobility_rate_2010,
y = merged$logpop,
xlab = "Upward Mobility",
ylab = "log10(Population)")
# let's look at the results:
summary(mobility_v_pop)
summary(mobility_v_pop)
summary(mobility_v_pop)
# let's look at the results:
summary(mobility_v_pop)
summary(mobility_v_pop)
mobility_v_pop <- lm(upward_mobility_rate_2010 ~ logpop, data = merged)
summary(mobility_v_pop)
sink()
sink(file = "output/mobility-pop-regression.txt")
summary(mobility_v_pop)
sink()
merged$az <- ifelse(merged$STATE_NAME_2010SVI == "Arizona", 1, 0)
merged$ca <- ifelse(merged$STATE_NAME_2010SVI == "California", 1, 0)
summary(mobility_v_pop_state)
mobility_v_pop_state <- lm(formula = upward_mobility_rate_2010 ~ logpop + az, data = merged)
summary(mobility_v_pop_state)
sink(file = "output/mobility-pop-state-regression.txt")
summary(mobility_v_pop)
sink()
# Student Activities
# 1. Variable exploration
boxplot(formula = upward_mobility_rate_2010 ~ STATE_NAME_2010SVI, data = merged_data)
aov(formula = upward_mobility_rate_2010 ~ COUNTY_2010SVI, data = ca)
View(upward_stats)
mobility_v_pop_state <- lm(formula = upward_mobility_rate_2020 ~ logpop + az + upward_mobility_means_2010, data = merged)
mobility_v_pop_state <- lm(formula = upward_mobility_rate_2020 ~ logpop + az + merged_stats_up, data = merged)
mobility_v_pop_state <- lm(formula = upward_mobility_rate_2020 ~ logpop + az + CENSUSDATA_2010SVI, data = merged)
View(merged)
mobility_v_pop_state <- lm(formula = upward_mobility_rate_2020 ~ logpop + az + EPOV_2018SVI, data = merged)
View(mobility_v_pop)
View(mobility_v_pop_state)
summary(mobility_v_pop_state)
mobility_v_pop_state <- lm(formula = upward_mobility_rate_2020 ~ logpop + az + E_POV_2018SVI, data = merged)
summary(mobility_v_pop_state)
